<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>HTML批量转TXT工具</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f7f7f7; }
        .container { background: #fff; padding: 30px 40px; border-radius: 8px; box-shadow: 0 2px 8px #0001; max-width: 500px; margin: auto; }
        h1 { font-size: 1.6em; margin-bottom: 20px; }
        input[type="file"] { margin-bottom: 20px; }
        button { padding: 10px 24px; font-size: 1em; border: none; border-radius: 4px; background: #0078d7; color: #fff; cursor: pointer; }
        button:disabled { background: #aaa; }
        .tip { color: #888; font-size: 0.95em; margin-bottom: 20px; }
        .result { margin-top: 20px; color: #4caf50; }
    </style>
</head>
<body>
<div class="container">
    <h1>HTML批量转TXT工具</h1>
    <div class="tip">请选择本地HTML文件（可多选），点击“转换并下载TXT”即可。</div>
    <input type="file" id="fileInput" accept=".html,.htm" multiple />
    <br>
    <button id="convertBtn" disabled>转换并下载TXT</button>
    <div class="result" id="result"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script>
const fileInput = document.getElementById('fileInput');
const convertBtn = document.getElementById('convertBtn');
const resultDiv = document.getElementById('result');

fileInput.addEventListener('change', () => {
    convertBtn.disabled = fileInput.files.length === 0;
    resultDiv.textContent = '';
});

convertBtn.addEventListener('click', async () => {
    const files = Array.from(fileInput.files);
    if (files.length === 0) return;
    convertBtn.disabled = true;
    resultDiv.textContent = '正在处理，请稍候...';
    const zip = new JSZip();
    for (const file of files) {
        const text = await file.text();
        // 解析HTML并提取纯文本
        const parser = new DOMParser();
        const doc = parser.parseFromString(text, 'text/html');
        // 去除script和style内容
        doc.querySelectorAll('script,style').forEach(e => e.remove());
        const pureText = doc.body ? doc.body.textContent : doc.textContent;
        // 保证文件名唯一
        let baseName = file.name.replace(/\.(html|htm)$/i, '');
        zip.file(baseName + '.txt', pureText);
    }
    // 生成ZIP并下载
    zip.generateAsync({type: 'blob'}).then(function(content) {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(content);
        a.download = 'html批量转txt结果.zip';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(a.href);
        resultDiv.textContent = '全部转换并打包完成！';
        convertBtn.disabled = false;
    });
});
</script>
</body>
</html> 